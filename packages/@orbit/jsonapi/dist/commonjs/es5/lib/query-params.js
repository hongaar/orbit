"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
function flattenObjectToParams(obj, path) {
    if (path === void 0) {
        path = [];
    }
    var params = [];
    Object.keys(obj).forEach(function (key) {
        if (!obj.hasOwnProperty(key)) {
            return;
        }
        var newPath = path.slice();
        newPath.push(key);
        if (typeof obj[key] === 'object') {
            Array.prototype.push.apply(params, flattenObjectToParams(obj[key], newPath));
        } else {
            params.push({
                path: newPath,
                val: obj[key]
            });
        }
    });
    return params;
}
function encodeQueryParams(obj) {
    return flattenObjectToParams(obj).map(function (param) {
        if (param.path.length === 1) {
            param.path = param.path[0];
        } else {
            var firstSegment = param.path[0];
            var remainingSegments = param.path.slice(1);
            param.path = firstSegment + '[' + remainingSegments.join('][') + ']';
        }
        return param;
    }).map(function (param) {
        return encodeURIComponent(param.path) + '=' + encodeURIComponent(param.val);
    }).join('&');
}
exports.encodeQueryParams = encodeQueryParams;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVlcnktcGFyYW1zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2xpYi9xdWVyeS1wYXJhbXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsK0JBQStCLEFBQUcsS0FBRSxBQUFTLE1BQVQ7eUJBQUE7ZUFBUztBQUMzQztRQUFJLEFBQU0sU0FBRyxBQUFFLEFBQUMsQUFFaEIsQUFBTTtXQUFDLEFBQUksS0FBQyxBQUFHLEFBQUMsS0FBQyxBQUFPLFFBQUMsVUFBQSxBQUFHLEtBQzFCLEFBQUUsQUFBQztZQUFDLENBQUMsQUFBRyxJQUFDLEFBQWMsZUFBQyxBQUFHLEFBQUMsQUFBQyxNQUFDLEFBQUMsQUFBQyxBQUFNLEFBQUMsQUFBQztBQUFDO0FBRXpDO1lBQUksQUFBTyxVQUFHLEFBQUksS0FBQyxBQUFLLEFBQUUsQUFBQyxBQUMzQixBQUFPO2dCQUFDLEFBQUksS0FBQyxBQUFHLEFBQUMsQUFBQyxBQUVsQixBQUFFLEFBQUM7WUFBQyxPQUFPLEFBQUcsSUFBQyxBQUFHLEFBQUMsU0FBSyxBQUFRLEFBQUMsVUFBQyxBQUFDLEFBQ2pDLEFBQUs7a0JBQUMsQUFBUyxVQUFDLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBTSxRQUFFLEFBQXFCLHNCQUFDLEFBQUcsSUFBQyxBQUFHLEFBQUMsTUFBRSxBQUFPLEFBQUMsQUFBQyxBQUFDLEFBQy9FLEFBQUMsQUFBQyxBQUFJO2VBQUMsQUFBQyxBQUNOLEFBQU07bUJBQUMsQUFBSTtzQkFDSCxBQUFPLEFBQ2IsQUFBRztxQkFBRSxBQUFHLElBRkUsQUFFRCxBQUFHLEFBQUMsQUFDZCxBQUFDLEFBQUMsQUFDTCxBQUFDLEFBQ0g7QUFKTSxBQUFJO0FBSVQsQUFBQyxBQUFDO0FBRUgsQUFBTTtXQUFDLEFBQU0sQUFBQyxBQUNoQixBQUFDOztBQUVELDJCQUFrQyxBQUFHLEtBQ25DLEFBQU07aUNBQXVCLEFBQUcsQUFBQyxLQUM5QixBQUFHLElBQUMsVUFBQSxBQUFLLE9BQ1IsQUFBRSxBQUFDO1lBQUMsQUFBSyxNQUFDLEFBQUksS0FBQyxBQUFNLFdBQUssQUFBQyxBQUFDLEdBQUMsQUFBQyxBQUM1QixBQUFLO2tCQUFDLEFBQUksT0FBRyxBQUFLLE1BQUMsQUFBSSxLQUFDLEFBQUMsQUFBQyxBQUFDLEFBQzdCLEFBQUMsQUFBQyxBQUFJO2VBQUMsQUFBQyxBQUNOO2dCQUFJLEFBQVksZUFBRyxBQUFLLE1BQUMsQUFBSSxLQUFDLEFBQUMsQUFBQyxBQUFDLEFBQ2pDO2dCQUFJLEFBQWlCLG9CQUFHLEFBQUssTUFBQyxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQUMsQUFBQyxBQUFDLEFBQzVDLEFBQUs7a0JBQUMsQUFBSSxPQUFHLEFBQVksZUFBRyxBQUFHLE1BQUcsQUFBaUIsa0JBQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxRQUFHLEFBQUcsQUFBQyxBQUN2RSxBQUFDO0FBQ0QsQUFBTTtlQUFDLEFBQUssQUFBQyxBQUNmLEFBQUMsQUFBQztBQVZHLEFBQXFCLE9BV3pCLEFBQUcsSUFBQyxVQUFBLEFBQUssT0FBSTtlQUFBLEFBQWtCLG1CQUFDLEFBQUssTUFBQyxBQUFJLEFBQUMsUUFBRyxBQUFHLE1BQUcsQUFBa0IsbUJBQUMsQUFBSyxNQUEvRCxBQUFnRSxBQUFHLEFBQUMsQUFBQztPQUNsRixBQUFJLEtBQUMsQUFBRyxBQUFDLEFBQUMsQUFDZixBQUFDOztBQWRELDRCQWNDIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gZmxhdHRlbk9iamVjdFRvUGFyYW1zKG9iaiwgcGF0aCA9IFtdKSB7XHJcbiAgbGV0IHBhcmFtcyA9IFtdO1xyXG5cclxuICBPYmplY3Qua2V5cyhvYmopLmZvckVhY2goa2V5ID0+IHtcclxuICAgIGlmICghb2JqLmhhc093blByb3BlcnR5KGtleSkpIHsgcmV0dXJuOyB9XHJcblxyXG4gICAgbGV0IG5ld1BhdGggPSBwYXRoLnNsaWNlKCk7XHJcbiAgICBuZXdQYXRoLnB1c2goa2V5KTtcclxuXHJcbiAgICBpZiAodHlwZW9mIG9ialtrZXldID09PSAnb2JqZWN0Jykge1xyXG4gICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShwYXJhbXMsIGZsYXR0ZW5PYmplY3RUb1BhcmFtcyhvYmpba2V5XSwgbmV3UGF0aCkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcGFyYW1zLnB1c2goe1xyXG4gICAgICAgIHBhdGg6IG5ld1BhdGgsXHJcbiAgICAgICAgdmFsOiBvYmpba2V5XVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIHBhcmFtcztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZVF1ZXJ5UGFyYW1zKG9iaikge1xyXG4gIHJldHVybiBmbGF0dGVuT2JqZWN0VG9QYXJhbXMob2JqKVxyXG4gICAgLm1hcChwYXJhbSA9PiB7XHJcbiAgICAgIGlmIChwYXJhbS5wYXRoLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgIHBhcmFtLnBhdGggPSBwYXJhbS5wYXRoWzBdO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCBmaXJzdFNlZ21lbnQgPSBwYXJhbS5wYXRoWzBdO1xyXG4gICAgICAgIGxldCByZW1haW5pbmdTZWdtZW50cyA9IHBhcmFtLnBhdGguc2xpY2UoMSk7XHJcbiAgICAgICAgcGFyYW0ucGF0aCA9IGZpcnN0U2VnbWVudCArICdbJyArIHJlbWFpbmluZ1NlZ21lbnRzLmpvaW4oJ11bJykgKyAnXSc7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHBhcmFtO1xyXG4gICAgfSlcclxuICAgIC5tYXAocGFyYW0gPT4gZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtLnBhdGgpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtLnZhbCkpXHJcbiAgICAuam9pbignJicpO1xyXG59XHJcbiJdfQ==